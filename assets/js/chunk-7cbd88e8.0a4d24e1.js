(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7cbd88e8"],{6891:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAMAAADW3miqAAAAjVBMVEUAAAD////d3d3m5ub////h4eH7+/vY2Njp6enx8fHX19fw8PDt7e3U1NTU1NT////////////S0tLa2trh4eHs7Oz////////MzMzOzs7////V1dXx8fHu7u7////u7u7MzMzi4uLr6+vt7e3x8fH////////////MzMzQ0NDZ2dn9/f3T09Pj4+Pc3Nx6rBOkAAAAKHRSTlMAXp2dYJ1epJ2VoZCLoJ1PSEGjfn18RDn78r+jmpU93s2jj417WFQvJdguCwAAAQJJREFUOMutlNkSgjAMRYNWFEHBBdz3LXX7/88TWjMdCOGJPEFzpmfa3Cm0Wd78md7k3sF8zBCx69Uyapz3zBeiRPl9JGguUWpaNI7W2zNUr0p5I7N+/f91aC/uwmgCEkUuDBIAkfKHZmWXAVSpAVGeZc53h7C91Ni6MgfQGYkiV7inJjeS6xIDiNRrZF109lrjW3C5vagicvFSJ4vo7QLkelnouW5glJ0X3aqcMeRz5HPX3yZKbYrmKljTrcqu8FGaEAgZk1JIrmWYsOSwPAf5HbLcc5ecVTV1Lonyyy5udHmOsvpMpPQW5LWNpeS4t2CXSCm00EfrVRrXp3Cm9RtarB/x6TUusji1vAAAAABJRU5ErkJggg=="},"6a6a":function(t,s,e){"use strict";var i=e("7134"),c=e.n(i);c.a},7134:function(t,s,e){},c228:function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"bottom-bar flex-row"},[e("div",{staticClass:"flex-y-center flex-grow-1",staticStyle:{padding:"0 24px"}},[e("div",{staticClass:"flex-grow-0 flex-y-center",staticStyle:{"margin-right":"20px"},on:{click:t.cartCheckAll}},[e("div",{staticClass:"cart-checkbox",class:{active:t.cart_check_all},staticStyle:{"margin-right":"10px"}},[t.cart_check_all?e("van-icon",{attrs:{name:"checked",size:"36px",color:"#f39800"}}):e("van-icon",{attrs:{name:"circle",color:"#ccc"}})],1),e("span",{staticStyle:{"white-space":"nowrap"}},[t._v("全选")])]),e("div",{staticClass:"flex-grow-1",staticStyle:{color:"#ff4544","white-space":"nowrap"}},[t._v("\n\t\t\t\t总计:￥"+t._s(t.total_price)+"\n\t\t\t")])]),t.show_cart_edit?[e("div",{staticClass:"flex-y-center flex-grow-0 flex-x-center edit-btn",on:{click:function(s){t.show_cart_edit=!1}}},[t._v("完成")]),e("div",{staticClass:"flex-y-center flex-grow-0 flex-x-center submit-btn",on:{click:t.cartDelete}},[t._v("删除")])]:[e("div",{staticClass:"flex-y-center flex-grow-0 flex-x-center edit-btn",on:{click:function(s){t.show_cart_edit=!0}}},[t._v("管理")]),e("div",{staticClass:"flex-y-center flex-grow-0 flex-x-center submit-btn",attrs:{bindtap:"cartSubmit"}},[t._v("结算")])]],2),t.show_no_data_tip?e("div",{staticClass:"no-data-tip"},[t._m(0),e("div",[t._v("购物车还是空的哦")])]):t._e(),e("div",{staticClass:"cart-list"},[t._l(t.cart_list,function(s,i){return e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"cart-item flex-row",attrs:{"infinite-scroll-immediate-check":"false","infinite-scroll-disabled":"loading","infinite-scroll-distance":"2"}},[s.disabled&&!t.show_cart_edit?e("div",{staticClass:"flex-grow-0 flex-y-center check-btn-wrap"}):e("div",{ref:"checkbtn",refInFor:!0,staticClass:"flex-grow-0 flex-y-center check-btn-wrap",on:{click:function(s){t.cartCheck(i)}}},[s.checked?e("div",{staticClass:"cart-checkbox"},[e("van-icon",{attrs:{color:"#f39800",size:"36px",name:"checked"}})],1):e("div",{staticClass:"cart-checkbox"},[e("van-icon",{attrs:{name:"circle"}})],1)]),e("div",{staticClass:"flex-grow-1"},[e("div",{staticClass:"flex-grow-1 flex-row"},[e("div",{staticClass:"flex-grow-0 flex-row",staticStyle:{"align-items":"center"}},[e("img",{staticClass:"goods-pic",attrs:{mode:"aspectFill",src:s.itemPic}})]),e("div",{staticClass:"flex-grow-1 flex-col"},[e("div",{staticClass:"flex-grow-1"},[e("div",{staticClass:"goods-name"},[e("div",[t._v(t._s(s.itemTitle))])]),e("div",{staticClass:"attr-list",staticStyle:{padding:"20px 0"}},[e("div",{staticClass:"attr-item",attrs:{"data-cartid":"item.cartId","data-itemid":"item.itemId"},on:{click:function(s){t.showAttrPicker(i)}}},[t._v("\n\t\t\t\t\t\t\t\t\t已选: "+t._s(s.specsConfig)+"\n\t\t\t\t\t\t\t\t\t"),e("div",{staticClass:"icon-bottom"},[e("image",{staticStyle:{width:"16px",height:"10px"},attrs:{src:"/images/jiantou-bottom.png"}})])])])]),e("div",{staticClass:"flex-grow-0 flex-row",staticStyle:{"justify-content":"space-between"}},[e("div",{staticClass:"flex-grow-1 price"},[t._v("￥:"+t._s(s.itemPrice)+"\n\t\t\t\t\t\t\t")]),e("div",{staticClass:"flex-grow-0 num"},[e("div",{staticClass:"change-buy-number-box flex-grow-0 flex-row number-input-box"},[e("span",{staticClass:"number-btn number-sub",on:{click:function(s){t.changeNumber(-1,i)}}},[t._v("-")]),e("input",{directives:[{name:"model",rawName:"v-model",value:s.buyNum,expression:"item.buyNum"}],staticClass:"number-input",attrs:{type:"number",min:"1"},domProps:{value:s.buyNum},on:{blur:t.numberBlur,input:function(e){e.target.composing||t.$set(s,"buyNum",e.target.value)}}}),e("span",{staticClass:"number-btn number-add",on:{click:function(s){t.changeNumber(1,i)}}},[t._v("+")])])])])])]),e("div",[s.num>s.max_num?e("span",{staticClass:"cart-tag"},[t._v("库存不足")]):t._e()])])])}),e("div",{staticStyle:{width:"100%",height:"40px","line-height":"40px","text-align":"center","font-size":"24px"},attrs:{hidden:'loading?"":true'}},[t._v("正在载入更多数据...")])],2),t.showModal?e("div",{staticClass:"attr-picker",on:{click:function(s){if(s.target!==s.currentTarget)return null;t.showModal=!1}}},[e("div",{staticClass:"content-box"},[e("div",{staticClass:"flex-row goodsboxtop"},[e("div",{staticClass:"goodsboxtopLeft flex-grow-0"},[e("img",{attrs:{src:t.goods.itemPic}})]),e("div",{staticClass:"goodsboxtopRight flex-grow-1"},[e("div",{staticClass:"goods-name"},[t._v(t._s(t.goods.itemTitle))]),e("div",{staticClass:"flex-row"},[2==t.userType&&t.memberLevel?e("div",{staticStyle:{color:"#ff4544"}},[t._v("￥"+t._s(t.specsConfigDetail?t.specsConfigDetail.vipMemberPrice:t.goods.vipMemberPrice)+" ")]):5==t.userType?e("div",{staticStyle:{color:"#ff4544"}},[t._v("￥"+t._s(t.specsConfigDetail?t.specsConfigDetail.bprices:t.goods.bprices)+" ")]):4==t.userType?e("div",{staticStyle:{color:"#ff4544"}},[t._v("￥"+t._s(t.specsConfigDetail?t.specsConfigDetail.fictitiousDistriPrice:t.goods.fictitiousDistriPrice)+" ")]):3==t.userType?e("div",{staticStyle:{color:"#ff4544"}},[t._v("￥"+t._s(t.specsConfigDetail?t.specsConfigDetail.distriPrice:t.goods.distriPrice)+" ")]):e("div",{staticStyle:{color:"#ff4544"}},[t._v("￥"+t._s(t.specsConfigDetail?t.specsConfigDetail.salePrice:t.goods.salePrice)+" ")])]),e("div",{staticStyle:{color:"#999"}},[t._v("库存: "+t._s(t.specsConfigDetail?t.specsConfigDetail.inventory:t.goods.inventory))]),e("div",{staticStyle:{color:"#999",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[t._v("已选: "+t._s(t.goods.specsConfig))])])]),t._l(t.goodsSpecsConfig,function(s,i){return s.specValues.length>0?e("div",{key:i,staticClass:"attr-group"},[e("div",{staticClass:"attr-group-name"},[t._v(t._s(s.name))]),e("div",{staticClass:"attr-list"},t._l(s.specValues,function(c,a){return e("span",{ref:"select",refInFor:!0,staticClass:"attr-item",class:{active:c.checked},attrs:{sort:i,cindex:a,name:s.name,keyname:"v"+(i+1)+"Id",groupid:s.specId,attrid:c.id},on:{click:function(s){t.menuClick(i,a)}}},[t._v(t._s(c.name))])}),0)]):t._e()}),e("div",{staticClass:"change-buy-number flex-row"},[e("span",{staticStyle:{}},[t._v("购买数量")]),e("div",{staticClass:"change-buy-number-box flex-grow-0 flex-row number-input-box"},[e("span",{staticClass:"number-btn number-sub",on:{click:function(s){t.changeNumber(-1,-1)}}},[t._v("-")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.goods.buyNum,expression:"goods.buyNum"}],staticClass:"number-input",attrs:{type:"number",min:"1"},domProps:{value:t.goods.buyNum},on:{blur:t.numberBlur,input:function(s){s.target.composing||t.$set(t.goods,"buyNum",s.target.value)}}}),e("span",{staticClass:"number-btn number-add",on:{click:function(s){t.changeNumber(1,-1)}}},[t._v("+")])])]),e("div",{staticClass:"cancelBtn flex-grow-0",staticStyle:{overflow:"visible"},on:{click:function(s){t.showModal=!1}}},[t._m(1)])],2)]):t._e()])},c=[function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"no-data-icon flex-y-center flex-x-center"},[i("img",{attrs:{src:e("3561")}})])},function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",[i("img",{attrs:{src:e("6891")}})])}],a=(e("28a5"),e("ac6a"),e("cadf"),e("551c"),e("097d"),{name:"Cart",data:function(){return{cart_list:[],total_price:0,show_cart_edit:!1,cart_check_all:!1,showModal:!1,goodsSpecsConfig:[],goods:{},noMore:!1}},created:function(){var t=sessionStorage.getItem("userType"),s=sessionStorage.getItem("memberLevel");this.userType=t,this.memberLevel=s,this.getCartList()},methods:{getCartList:function(){var t=this;this.show_no_data_tip=!1;var s={page:{pageNum:1,pageSize:10}};this.$http.post(this.api.cart.list,s).then(function(s){if(1e4==s.code){var e=s.data;e.forEach(function(t,s){t.specsConfigDetail=JSON.parse(t.specsConfigDetail),t.goodsSpecsConfig=JSON.parse(t.goodsSpecsConfig),t.checked=t.checked||!1,t.attrList=t.specsConfig.split("、")}),t.cart_list=e,t.total_price=0,t.cart_check_all=!1,t.show_cart_edit=!1,t.show_no_data_tip=0==t.cart_list.length}})},cartCheck:function(t){this.cart_list[t].checked=!this.cart_list[t].checked,this.updateTotalPrice()},updateTotalPrice:function(){var t=0,s=!0;this.cart_list.forEach(function(e){e.checked&&(t+=e.itemPrice*e.buyNum),s=s&&e.checked}),this.cart_check_all=s,this.total_price=t},changeNumber:function(t,s){if(s>-1){if(this.goods=this.cart_list[s],-1==t&&1==this.cart_list[s].buyNum)return;if(1==t&&this.cart_list[s].buyNum>=this.cart_list[s].inventory)return;this.cart_list[s].buyNum+=t}else{if(-1==t&&1==this.goods.buyNum)return;if(1==t&&this.goods.buyNum>=this.goods.inventory)return;this.goods.buyNum+=t}this.changeGoods(),this.updateTotalPrice()},numberBlur:function(){},cartDelete:function(){var t=this,s=[];this.cart_list.forEach(function(t){t.checked&&s.push(t.cartId)}),0!=s.length&&this.$dialog.confirm({title:"提示",message:"确认删除"+s.length+"项内容？"}).then(function(){t.$http.post(t.api.cart.delete,{cartId:s.join(",")}).then(function(s){1e4==s.code?(t.$toast.success("删除成功"),t.getCartList()):t.$toast.success("删除失败")})}).catch(function(){})},cartCheckAll:function(){this.cart_check_all=!this.cart_check_all;var t=this;this.cart_list.forEach(function(s){s.disabled&&!t.show_cart_edit||(s.checked=t.cart_check_all)}),this.cart_list.length>0&&this.updateTotalPrice()},showAttrPicker:function(t){var s=this;this.showModal=!0,this.goods=this.cart_list[t],this.cart_list[t].priceList||this.$http.post(this.api.default.goods_price,{itemId:this.goods.itemId}).then(function(e){1e4==e.code&&(s.cart_list[t].priceList=JSON.parse(e.data))}),this.goodsSpecsConfig=this.cart_list[t].goodsSpecsConfig,this.specsConfigDetail=this.cart_list[t].specsConfigDetail;for(var e=this,i=0;i<e.goodsSpecsConfig.length;i++)for(var c=0;c<e.goodsSpecsConfig[i].specValues.length;c++)e.goodsSpecsConfig[i].specValues[c].id==e.specsConfigDetail["v"+(i+1)+"Id"]?this.$set(e.goodsSpecsConfig[i].specValues[c],"checked",!0):this.$set(e.goodsSpecsConfig[i].specValues[c],"checked",!1)},menuClick:function(t,s){for(var e=0;e<this.goodsSpecsConfig[t].specValues.length;e++)e==s?this.$set(this.goodsSpecsConfig[t].specValues[e],"checked",!0):this.$set(this.goodsSpecsConfig[t].specValues[e],"checked",!1);this.$nextTick(function(){var t=[],s={};this.$refs.select.forEach(function(e){"attr-item active"==e.className&&(t.push(e.innerText),s[e.getAttribute("keyname")]=e.getAttribute("attrid"))}),this.goods.specsConfig=t.join("、"),this.arr=t,this.selectAttr=s;var e=this.goods.priceList,i=this;e.forEach(function(t){var e=!0;for(var c in s)e=e&&t[c]==s[c];e&&(i.specsConfigDetail=t)}),i.changeGoods()})},changeGoods:function(){var t={cartId:this.goods.cartId,distriId:this.goods.distriId,itemId:this.goods.itemId,buyNum:this.goods.buyNum,specsConfig:this.goods.specsConfig,specsConfigDetail:this.goods.specsConfigDetail};this.$http.post(this.api.cart.update,t).then(function(t){t.code})},loadMore:function(){}}}),o=a,r=(e("6a6a"),e("2877")),n=Object(r["a"])(o,i,c,!1,null,"79833110",null);n.options.__file="Cart.vue";s["default"]=n.exports}}]);