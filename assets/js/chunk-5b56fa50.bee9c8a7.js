(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b56fa50"],{3876:function(t,e,s){"use strict";var i=s("62f3"),c=s.n(i);c.a},"62f3":function(t,e,s){},6891:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAMAAADW3miqAAAAjVBMVEUAAAD////d3d3m5ub////h4eH7+/vY2Njp6enx8fHX19fw8PDt7e3U1NTU1NT////////////S0tLa2trh4eHs7Oz////////MzMzOzs7////V1dXx8fHu7u7////u7u7MzMzi4uLr6+vt7e3x8fH////////////MzMzQ0NDZ2dn9/f3T09Pj4+Pc3Nx6rBOkAAAAKHRSTlMAXp2dYJ1epJ2VoZCLoJ1PSEGjfn18RDn78r+jmpU93s2jj417WFQvJdguCwAAAQJJREFUOMutlNkSgjAMRYNWFEHBBdz3LXX7/88TWjMdCOGJPEFzpmfa3Cm0Wd78md7k3sF8zBCx69Uyapz3zBeiRPl9JGguUWpaNI7W2zNUr0p5I7N+/f91aC/uwmgCEkUuDBIAkfKHZmWXAVSpAVGeZc53h7C91Ni6MgfQGYkiV7inJjeS6xIDiNRrZF109lrjW3C5vagicvFSJ4vo7QLkelnouW5glJ0X3aqcMeRz5HPX3yZKbYrmKljTrcqu8FGaEAgZk1JIrmWYsOSwPAf5HbLcc5ecVTV1Lonyyy5udHmOsvpMpPQW5LWNpeS4t2CXSCm00EfrVRrXp3Cm9RtarB/x6TUusji1vAAAAABJRU5ErkJggg=="},c228:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"bottom-bar flex-row"},[s("div",{staticClass:"flex-y-center flex-grow-1",staticStyle:{padding:"0 24px"}},[s("div",{staticClass:"flex-grow-0 flex-y-center",staticStyle:{"margin-right":"20px"},on:{click:t.cartCheckAll}},[s("div",{staticClass:"cart-checkbox",class:{active:t.cart_check_all},staticStyle:{"margin-right":"10px"}},[t.cart_check_all?s("van-icon",{attrs:{name:"checked",color:"#f39800"}}):s("van-icon",{attrs:{name:"circle",color:"#ccc"}})],1),s("span",{staticStyle:{"white-space":"nowrap"}},[t._v("全选")])]),s("div",{staticClass:"flex-grow-1",staticStyle:{color:"#ff4544","white-space":"nowrap"}},[t._v("\n\t\t\t\t总计:￥"+t._s(t.total_price)+"\n\t\t\t")])]),t.show_cart_edit?[s("div",{staticClass:"flex-y-center flex-grow-0 flex-x-center edit-btn",on:{click:function(e){t.show_cart_edit=!1}}},[t._v("完成")]),s("div",{staticClass:"flex-y-center flex-grow-0 flex-x-center submit-btn",on:{click:t.cartDelete}},[t._v("删除")])]:[s("div",{staticClass:"flex-y-center flex-grow-0 flex-x-center edit-btn",on:{click:function(e){t.show_cart_edit=!0}}},[t._v("管理")]),s("div",{staticClass:"flex-y-center flex-grow-0 flex-x-center submit-btn",on:{click:t.cartSubmit}},[t._v("结算")])]],2),t.show_no_data_tip?s("div",{staticClass:"no-data-tip"},[t._m(0),s("div",[t._v("购物车还是空的哦")])]):t._e(),s("div",{staticClass:"cart-list"},[t._l(t.cart_list,function(e,i){return s("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"cart-item flex-row",attrs:{"infinite-scroll-immediate-check":"false","infinite-scroll-disabled":"loading","infinite-scroll-distance":"110"}},[e.disabled&&!t.show_cart_edit?s("div",{staticClass:"flex-grow-0 flex-y-center check-btn-wrap"}):s("div",{ref:"checkbtn",refInFor:!0,staticClass:"flex-grow-0 flex-y-center check-btn-wrap",on:{click:function(e){t.cartCheck(i)}}},[e.checked?s("div",{staticClass:"cart-checkbox"},[s("van-icon",{attrs:{color:"#f39800",name:"checked"}})],1):s("div",{staticClass:"cart-checkbox"},[s("van-icon",{attrs:{name:"circle"}})],1)]),s("div",{staticClass:"flex-grow-1"},[s("div",{staticClass:"flex-grow-1 flex-row"},[s("div",{staticClass:"flex-grow-0 flex-row",staticStyle:{"align-items":"center"}},[s("img",{staticClass:"goods-pic",attrs:{mode:"aspectFill",src:e.itemPic}})]),s("div",{staticClass:"flex-grow-1 flex-col"},[s("div",{staticClass:"flex-grow-1"},[s("div",{staticClass:"goods-name"},[s("div",[t._v(t._s(e.itemTitle))])]),s("div",{staticClass:"attr-list",staticStyle:{padding:"20px 0"}},[s("div",{staticClass:"attr-item",attrs:{"data-cartid":"item.cartId","data-itemid":"item.itemId"},on:{click:function(e){t.showAttrPicker(i)}}},[t._v("\n\t\t\t\t\t\t\t\t\t已选: "+t._s(e.specsConfig)+"\n\t\t\t\t\t\t\t\t\t"),s("div",{staticClass:"icon-bottom"},[s("image",{staticStyle:{width:"16px",height:"10px"},attrs:{src:"/images/jiantou-bottom.png"}})])])])]),s("div",{staticClass:"flex-grow-0 flex-row",staticStyle:{"justify-content":"space-between"}},[s("div",{staticClass:"flex-grow-1 price"},[t._v("￥:"+t._s(e.itemPrice)+"\n\t\t\t\t\t\t\t")]),s("div",{staticClass:"flex-grow-0 num"},[s("div",{staticClass:"change-buy-number-box flex-grow-0 flex-row number-input-box"},[s("span",{staticClass:"number-btn number-sub",on:{click:function(e){t.changeNumber(-1,i)}}},[t._v("-")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.buyNum,expression:"item.buyNum"}],staticClass:"number-input",attrs:{type:"number",min:"1"},domProps:{value:e.buyNum},on:{blur:t.numberBlur,input:function(s){s.target.composing||t.$set(e,"buyNum",s.target.value)}}}),s("span",{staticClass:"number-btn number-add",on:{click:function(e){t.changeNumber(1,i)}}},[t._v("+")])])])])])]),s("div",[e.num>e.max_num?s("span",{staticClass:"cart-tag"},[t._v("库存不足")]):t._e()])])])}),s("div",{staticStyle:{width:"100%",height:"40px","line-height":"40px","text-align":"center","font-size":"24px"},attrs:{hidden:'loading?"":true'}},[t._v("正在载入更多数据...")]),t.noMore?s("div",{staticStyle:{color:"#ccc"}},[t._v("\n\t\t\t我是有底线的\n\t\t")]):t._e()],2),t.showModal?s("div",{staticClass:"attr-picker",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showModal=!1}}},[s("div",{staticClass:"content-box"},[s("div",{staticClass:"flex-row goodsboxtop"},[s("div",{staticClass:"goodsboxtopLeft flex-grow-0"},[s("img",{attrs:{src:t.goods.itemPic}})]),s("div",{staticClass:"goodsboxtopRight flex-grow-1"},[s("div",{staticClass:"goods-name"},[t._v(t._s(t.goods.itemTitle))]),s("div",{staticClass:"flex-row"},[2==t.userType&&t.memberLevel?s("div",{staticStyle:{color:"#ff4544"}},[t._v("￥"+t._s(t.specsConfigDetail?t.specsConfigDetail.vipMemberPrice:t.goods.vipMemberPrice)+" ")]):5==t.userType?s("div",{staticStyle:{color:"#ff4544"}},[t._v("￥"+t._s(t.specsConfigDetail?t.specsConfigDetail.bprices:t.goods.bprices)+" ")]):4==t.userType?s("div",{staticStyle:{color:"#ff4544"}},[t._v("￥"+t._s(t.specsConfigDetail?t.specsConfigDetail.fictitiousDistriPrice:t.goods.fictitiousDistriPrice)+" ")]):3==t.userType?s("div",{staticStyle:{color:"#ff4544"}},[t._v("￥"+t._s(t.specsConfigDetail?t.specsConfigDetail.distriPrice:t.goods.distriPrice)+" ")]):s("div",{staticStyle:{color:"#ff4544"}},[t._v("￥"+t._s(t.specsConfigDetail?t.specsConfigDetail.salePrice:t.goods.salePrice)+" ")])]),s("div",{staticStyle:{color:"#999"}},[t._v("库存: "+t._s(t.specsConfigDetail?t.specsConfigDetail.inventory:t.goods.inventory))]),s("div",{staticStyle:{color:"#999",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[t._v("已选: "+t._s(t.goods.specsConfig))])])]),t._l(t.goodsSpecsConfig,function(e,i){return e.specValues.length>0?s("div",{key:i,staticClass:"attr-group"},[s("div",{staticClass:"attr-group-name"},[t._v(t._s(e.name))]),s("div",{staticClass:"attr-list"},t._l(e.specValues,function(c,a){return s("span",{ref:"select",refInFor:!0,staticClass:"attr-item",class:{active:c.checked},attrs:{sort:i,cindex:a,name:e.name,keyname:"v"+(i+1)+"Id",groupid:e.specId,attrid:c.id},on:{click:function(e){t.menuClick(i,a)}}},[t._v(t._s(c.name))])}),0)]):t._e()}),s("div",{staticClass:"change-buy-number flex-row"},[s("span",{staticStyle:{}},[t._v("购买数量")]),s("div",{staticClass:"change-buy-number-box flex-grow-0 flex-row number-input-box"},[s("span",{staticClass:"number-btn number-sub",on:{click:function(e){t.changeNumber(-1,-1)}}},[t._v("-")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.goods.buyNum,expression:"goods.buyNum"}],staticClass:"number-input",attrs:{type:"number",min:"1"},domProps:{value:t.goods.buyNum},on:{blur:t.numberBlur,input:function(e){e.target.composing||t.$set(t.goods,"buyNum",e.target.value)}}}),s("span",{staticClass:"number-btn number-add",on:{click:function(e){t.changeNumber(1,-1)}}},[t._v("+")])])]),s("div",{staticClass:"cancelBtn flex-grow-0",staticStyle:{overflow:"visible"},on:{click:function(e){t.showModal=!1}}},[t._m(1)])],2)]):t._e()])},c=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"no-data-icon flex-y-center flex-x-center"},[i("img",{attrs:{src:s("3561")}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("img",{attrs:{src:s("6891")}})])}],a=(s("28a5"),s("ac6a"),{name:"Cart",data:function(){return{cart_list:[],total_price:0,show_cart_edit:!1,cart_check_all:!1,showModal:!1,goodsSpecsConfig:[],goods:{},noMore:!1,page:{pageNum:1,pageSize:10}}},created:function(){var t=sessionStorage.getItem("userType"),e=sessionStorage.getItem("memberLevel");this.userType=t,this.memberLevel=e,this.getCartList()},methods:{getCartList:function(t){var e=this;this.show_no_data_tip=!1,this.$http.post(this.api.cart.list,{page:this.page}).then(function(t){if(e.loading=!1,1e4==t.code){var s=t.data;s.forEach(function(t,e){t.specsConfigDetail=JSON.parse(t.specsConfigDetail),t.goodsSpecsConfig=JSON.parse(t.goodsSpecsConfig),t.checked=t.checked||!1,t.attrList=t.specsConfig.split("、")}),e.cart_list=e.cart_list.concat(s),e.total_price=0,e.cart_check_all=!1,e.show_cart_edit=!1,e.show_no_data_tip=0==e.cart_list.length,e.noMore=0==s.length,e.page={pageNum:e.page.pageNum+1,pageSize:10}}else e.total_price=0,e.cart_check_all=!1,e.show_cart_edit=!1})},cartCheck:function(t){this.cart_list[t].checked=!this.cart_list[t].checked,this.updateTotalPrice()},updateTotalPrice:function(){var t=0,e=!0;this.cart_list.forEach(function(s){s.checked&&(t+=s.itemPrice*s.buyNum),e=e&&s.checked}),this.cart_check_all=e,this.total_price=t},changeNumber:function(t,e){if(e>-1){if(this.goods=this.cart_list[e],-1==t&&1==this.cart_list[e].buyNum)return;if(1==t&&this.cart_list[e].buyNum>=this.cart_list[e].inventory)return;this.cart_list[e].buyNum+=t}else{if(-1==t&&1==this.goods.buyNum)return;if(1==t&&this.goods.buyNum>=this.goods.inventory)return;this.goods.buyNum+=t}this.changeGoods(),this.updateTotalPrice()},numberBlur:function(){},cartSubmit:function(){var t=this.cart_list.filter(function(t){return 1==t.checked});0!=t.length&&(t.map(function(t){return t.number=t.buyNum}),this.$router.push({name:"order.submit",params:{goodsList:t}}))},cartDelete:function(){var t=this,e=[];this.cart_list.forEach(function(t){t.checked&&e.push(t.cartId)}),0!=e.length&&this.$dialog.confirm({title:"提示",message:"确认删除"+e.length+"项内容？"}).then(function(){t.$http.post(t.api.cart.delete,{cartId:e.join(",")}).then(function(e){1e4==e.code?(t.$toast.success("删除成功"),t.getCartList()):t.$toast.success("删除失败")})}).catch(function(){})},cartCheckAll:function(){this.cart_check_all=!this.cart_check_all;var t=this;this.cart_list.forEach(function(e){e.disabled&&!t.show_cart_edit||(e.checked=t.cart_check_all)}),this.cart_list.length>0&&this.updateTotalPrice()},showAttrPicker:function(t){var e=this;this.showModal=!0,this.goods=this.cart_list[t],this.cart_list[t].priceList||this.$http.post(this.api.default.goods_price,{itemId:this.goods.itemId}).then(function(s){1e4==s.code&&(e.cart_list[t].priceList=JSON.parse(s.data))}),this.goodsSpecsConfig=this.cart_list[t].goodsSpecsConfig,this.specsConfigDetail=this.cart_list[t].specsConfigDetail;for(var s=this,i=0;i<s.goodsSpecsConfig.length;i++)for(var c=0;c<s.goodsSpecsConfig[i].specValues.length;c++)s.goodsSpecsConfig[i].specValues[c].id==s.specsConfigDetail["v"+(i+1)+"Id"]?this.$set(s.goodsSpecsConfig[i].specValues[c],"checked",!0):this.$set(s.goodsSpecsConfig[i].specValues[c],"checked",!1)},menuClick:function(t,e){for(var s=0;s<this.goodsSpecsConfig[t].specValues.length;s++)s==e?this.$set(this.goodsSpecsConfig[t].specValues[s],"checked",!0):this.$set(this.goodsSpecsConfig[t].specValues[s],"checked",!1);this.$nextTick(function(){var t=[],e={};this.$refs.select.forEach(function(s){"attr-item active"==s.className&&(t.push(s.innerText),e[s.getAttribute("keyname")]=s.getAttribute("attrid"))}),this.goods.specsConfig=t.join("、"),this.arr=t,this.selectAttr=e;var s=this.goods.priceList,i=this;s.forEach(function(t){var s=!0;for(var c in e)s=s&&t[c]==e[c];s&&(i.specsConfigDetail=t)}),i.changeGoods()})},changeGoods:function(){var t={cartId:this.goods.cartId,distriId:this.goods.distriId,itemId:this.goods.itemId,buyNum:this.goods.buyNum,specsConfig:this.goods.specsConfig,specsConfigDetail:this.goods.specsConfigDetail};this.$http.post(this.api.cart.update,t).then(function(t){t.code})},loadMore:function(){var t=this;this.noMore||this.loading||(this.isMoreLoading=!0,this.loading=!0,setTimeout(function(){t.getCartList({pageNum:t.page.pageNum+1,pageSize:10})},100))}}}),o=a,n=(s("3876"),s("2877")),r=Object(n["a"])(o,i,c,!1,null,"49316644",null);r.options.__file="Cart.vue";e["default"]=r.exports}}]);